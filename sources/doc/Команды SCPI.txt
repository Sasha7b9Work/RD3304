*** От считывателя ***
#CARD INSERTED ***UID***
#CARD EJECTED ***UID***

*** К считывателю ***
* #INFO?              - запрос информации о считывателе
* #MODE PROGRAM/WORK  - если мы хотим записывать карты, нужно перевести считыватель в режмим PROGRAM.
                        После окончания - вернуться в режим WORK
* #PASSWORD ACCESS    - задаёт пароль доступа к программируемой карте. 
  #PASSWORD ACCESS FULL - отключает аутентификацию
* #PASSWORD DISABLE   - отключить пароль на текущей карте
* #PASSWORD SET       - установить пароль на текущую карту
* #PASSWORD ENABLE    - включает защиту от записи и чтения
  
* #MAKE MASTER        - делает мастер-карту
* #MAKE USER          - делает карту доступа
  
* #RESET              - сброс считывателя на заводские настройки
* #WRITE              - запись на карту
* #READ               - чтение с карты

DD - десятичное значение
HH - шестнадцатиричное значение

*** Присылается считывателем ***
#CARD INSERTED ***UID***    - карта на считыватель
#CARD EJECTED ***UID***     - карта удалена

*** Запросы ***
#INFO?                    - возвращает информацию о считывателе
    Открываем порт. Посылаем запрос. Если приходит ответ требуемого формата - считыватель подключен.
    Далее периодически проверяем наличие считывателя этой командой. Если ответа нет - считыватель
    отключён.
    Ответ:
    #INFO DDDDDDDD \      серийный номер (200h)
          DDDDD  \        версия загрузчика (204h)
          DDDDD  \        аппаратная версия (206h)
          DDDDD  \        конфигурация изделия (208h)
          DDDDDDDD  \     дата производства (210h)
          DDDDDDDDDDDD    МАС (214h)

#PASSWORD ACCESS DDDDDDDDD   - текущий пароль. Используется для доступа к карте. Этой командой перебираются
                               пароли из архива паролей

#PASSWORD DISABLE            - отключает защиту от чтения и записи
#PASSWORD SET DDDDDDDDDD     - установить пароль на текущую карту
#PASSWORD ENABLE             - включает защиту от чтения и записи

#MAKE MASTER DDDD      \ заводской пароль
       4     DDDD      \ новый пароль. Будет установлен на считыватель
       5     D         \ WEIGAND
       6     HHHHHHHH  \ red
       7     HHHHHHHH  \ green
       8     D         \ мелодия 1
       9     D         \ мелодия 2
      10     D         \ мелодия 3
      11     D         \ громкость 1
      12     D         \ громкость 2
      13     D         \ громкость 3
      14     D         \ размер считываемого номера карты (4)
      15     D         \ начало номера карты в блоках (4)
      16     D         \ время блокирования замка, сек
      17     D         \ время србатывания сирены, сек
      18     D         \ режим охраны     : 1 - вкл, 0 - откл
      19     D         \ автономный режим : 1 - вкл, 0 - откл 
      20     D         \ адрес OSDP       : 1...127
      21     D         \ скорость OSDP    : 9600, 19200, 38400
      22     HHH...HHH \ строка шестнадцатиричных симоволов, в которой закодированы разрешения на доступ для карт.
                       \     В каждом символе четыре карты. Идут побайтово. В байте расположены станартно.
                       \     Младший байт соотвествует первым восьми картам
      23     HHHHHHHH  \ контрольная сумма - для всех символов кроме пробела перед данным полем

#MAKE MASTER DDDDD новый_пароль HASHHHHH. Карта без конфигурации

#MAKE USER NUMBER_CARD HASHHHHH  - записывает карту доступа. Но фактически эта команда нужна только если мы хотим установить новый номер карты.
                        Если нужно только изменить пароль, делаем #PASSWORD SET


#WRITE NUM_BLOCK HH HH HH HH HH HH ...   - записать байты, начиная с нулевого байта блока NUM_BLOCK. Заканчивается,
                                           как и все команды, на \r\n
#READ NUM_BLOCK COUNT


*** Изготовление мастер карты ****
#PASSWORD ACCESS   - устанавливаем пароль доступа к карте
#PASSWORD DISABLE  - отключаем защиту на карте
#MAKE MASTER ....  - записываем данные в мастер-карту
#PASSWORD SET      - устанавливаем пароль
#PASSWORD ENABLE   - включаем защиту на карте


*** Заливка прошивки ***
#UPGRADE size, где size указывает на размер заливаемого файла
    Далее считыватель выдаёт команды вида
    #BULK size, где size - размер запрашиваемой порции данных
    Внешняя программа в ответ присылает просто запрашиваемый блок данных




04 : [FF FF FF FF]  Это признак мастер-карты
05 : [31 31 31 31]  Заводской пароль   Если здесь не заводской пароль, то это карта установки нового пароля на считыватель
06 : [32 32 32 32]  Новый пароль
07 : [00 01 02 03]  WEIGAND(7:0)    RED(7:1...3)
08 : [04 05 06 07]  Мелодия(8:0)    GREEN(8:1...3)
09 : [08 09 0A 0B]  Громкость(9:0) Размер номера(9:1) Начало номера(9:2)

41 : [04 00 00 04]  3   - номер первого защищённого сектора
42 : [80 05 00 00]  0:7 - защита записи и чтения
      0  1  2  3
43 : [31 31 31 31]  заводской пароль
      4  5
44 : [31 31 00 00]  0...1 - PACK